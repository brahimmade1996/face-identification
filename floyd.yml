env: tensorflow-1.12

task:
    train:
        machine: gpu
        input:
          - source: tomasmikeska/datasets/lfw-funneled-compressed/16
            destination: dataset
        description: Train FaceNet
        # command: make setup-env && DATASET=/floyd/input/dataset/dataset.npy MODEL_SAVE_PATH=/floyd/home/ python src/train_triplets.py
        command: DATASET=/floyd/input/dataset/dataset.npy MODEL_SAVE_PATH=/floyd/home/ python src/train_triplets.py

    process_dataset:
        machine: cpu
        input:
            - source: tomasmikeska/datasets/vggface2/1
              destination: dataset
        description: Preprocess dirty dataset images
        command: make setup-env && VGG_DATASET=/floyd/input/dataset/ python src/vggface2_dataset.py
